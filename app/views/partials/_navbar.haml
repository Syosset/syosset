%header.header
  .header-main.container
    .container
      %h1.logo.pull-left
        = link_to root_path do
          = svg 'logo'
          .full-name.pull-right.visible-lg
            = svg 'full_name'
      .info.col-md-4-col-sm-4.pull-right
        %br
        %br
        %ul.menu-top.navbar-right.hidden-xs
          %li.divider
            = link_to t('nav.home'), root_path
          %li
            = link_to t('nav.contact'), root_path #TODO: link
        .contact
          %p.phone
            %i.fa.fa-phone
            = t('contact.phone')
          %p.email
            %i.fa.fa-envelope
            = t('contact.email')

%nav.main-nav{role: :navigation}
  .container
    .navbar-header
      %button.navbar-toggle{"data-target" => "#navbar-collapse", "data-toggle" => "collapse", :type => "button"}
        %span.sr-only Toggle navigation
        %span.icon-bar
        %span.icon-bar
        %span.icon-bar
    #navbar-collapse.navbar-collapse.collapse
      %ul.nav.navbar-nav
        %li.nav-item{class: active_controller('welcome', 'index')}
          = link_to t('nav.home'), root_path
        %li.nav-item{class: active_controller('welcome', 'about')}
          = link_to t('nav.about'), about_path
        %li.nav-item.dropdown
          %a.dropdown-toggle{"data-close-others" => "false", "data-delay" => "0", "data-hover" => "dropdown", "data-toggle" => "dropdown", :href => "#"}
            = t('nav.departments')
            %i.fa.fa-angle-down
          %ul.dropdown-menu
            %li= link_to "All #{t('nav.departments')}", departments_path
            - @departments.each do |department|
              %li= link_to department.name, department
        %li.nav-item
          = link_to t('nav.extracurriculars'), activities_path

        - if user_signed_in? && current_user.super_admin?
          %li.nav-item{class: active_controller('admin/base', 'index')}
            = link_to t('nav.admin'), admin_root_path
      %ul.nav.navbar-nav.pull-right
        %li.nav-item.red-white-display
          = link_to "#" do
            - if color = $redis.get("current_day_color")
              %i.fa{class: "#{color == "Red Day" ? "fa-map-o" : "fa-map"}"}
              Today is a
              = color
            - else
              %i.fa.fa-thumbs-up
              No school today
        - if user_signed_in?
          %li.nav-item
            %a
              - if current_user.super_admin
                %i.fa.fa-shield
              = current_user.name
          %li.nav-item
            = link_to t('menu.account.sign_out'), destroy_user_session_path, :method => :delete
        - else
          %li.nav-item
            = link_to user_google_oauth2_omniauth_authorize_path do
              = t('menu.account.sign_in_with')
              %i.fa.fa-google-plus-square
        - if user_signed_in?
          %li.nav-item.dropdown
            %a.dropdown-toggle{"data-close-others" => "false", "data-delay" => "0", "data-hover" => "dropdown", "data-toggle" => "dropdown", :href => "#"}
              %span.badge.visible-md-inline.visible-lg-inline{class: @alert_count > 0 ? "badge-warning" : ""}= @alert_count
              .visible-xs.visible-sm
                %i.fa.fa-exclamation-circle
                Alerts
                %b.caret
            %ul.dropdown-menu.dropdown-menu-right
              %li= link_to "See all alerts", alerts_path
              - @alerts.each do |alert|
                %li= render partial: 'partials/alerts/alert', object: alert
              - if @alert_count > 25
                %li
                  %a{:href => alerts_path} And #{@alert_count - 25} more...
              - if @alert_count == 0
                %li
                  %a{href: ""} No unread alerts!
  .peek-container
    .container
      = render 'peek/bar'
